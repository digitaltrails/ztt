{% extends "admin/change_list.html" %}

{% block extrahead %}
{{ block.super }}
<style>
@media print {
    #changelist-filter {
        display: none !important;
    }

    .print-filter-summary {
        display: block !important;
        background: #f8f9fa !important;
        border: 1px solid #dee2e6 !important;
        padding: 8px 12px !important;
        margin-bottom: 15px !important;
        border-radius: 4px !important;
        font-size: 14pt !important;
    }
}

.print-filter-summary {
    display: none;
}
</style>

<script>
function extractFilterSummary() {
    const filterNav = document.querySelector('nav#changelist-filter');
    if (!filterNav) return [];

    const filterSummary = [];
    const filterSections = filterNav.querySelectorAll('details[data-filter-title]');

    filterSections.forEach(section => {
        const filterTitle = section.getAttribute('data-filter-title');
        const selectedItem = section.querySelector('li.selected a');

        if (selectedItem && selectedItem.textContent.trim() !== 'All') {
            let value = selectedItem.textContent.replace('Ã—', '').trim();
            filterSummary.push({
                filter: filterTitle,
                value: value
            });
        }
    });

    return filterSummary;
}

document.addEventListener('DOMContentLoaded', function() {
    const filters = extractFilterSummary();
    if (filters.length === 0) return;

    const filterSummary = document.createElement('div');
    filterSummary.className = 'print-filter-summary';

    let html = '<strong>Applied Filters:</strong><ul style="margin: 8px 0 0 0; padding-left: 20px;">';
    filters.forEach(item => {
        html += `<li><strong>${item.filter}:</strong> ${item.value}</li>`;
    });
    html += '</ul>';

    filterSummary.innerHTML = html;

    const results = document.querySelector('#changelist .results');
    if (results) {
        results.parentNode.insertBefore(filterSummary, results);
    }
});
</script>
{% endblock %}

{% block content %}
{{ block.super }}
{% endblock %}